"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[13704],{43086:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DeprecatedCarousel_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"usePinCarouselData_pin"}],type:"Pin",abstractKey:null};n.hash="4be444081491499e2b6e9d6768314918";let a=n},385505:(e,t,i)=>{var n,a,l;i.r(t),i.d(t,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"altText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"autoAltText",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l=[n={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"474x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},a],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isThirdPartyAd",storageKey:null},{args:null,kind:"FragmentSpread",name:"StoryPinImage_pin"},{args:null,kind:"FragmentSpread",name:"DeprecatedCarousel_pin"}],type:"Pin",abstractKey:null};r.hash="228ed96182ff017f2d866065cbecf7b9";let s=r},708303:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinVideoWithVisibility_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{args:null,kind:"FragmentSpread",name:"PinVideo_pin"},{args:null,kind:"FragmentSpread",name:"useAutoplayOrgVideoOnHover_pin"}],type:"Pin",abstractKey:null};n.hash="8e6a9272e57ad1033c4bf432c3adf854";let a=n},559210:(e,t,i)=>{var n,a;i.r(t),i.d(t,{default:()=>r});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinVideo_pin",selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[a={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebCloseup",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[n,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PinImage_pin"}],type:"Pin",abstractKey:null};l.hash="72a606f26ad161609980c86fe071d95e";let r=l},742897:(e,t,i)=>{var n,a,l,r;i.r(t),i.d(t,{default:()=>o});let s=(r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l=[n={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"474x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"736x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[r],storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinPage",kind:"LinkedField",name:"pages",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blocks",plural:!0,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"blockType",storageKey:null},{alias:null,args:null,concreteType:"StoryPinVideoMetadataFormattedV2",kind:"LinkedField",name:"videoDataV2",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"version",value:"V_HLSV3_MOBILE"}],concreteType:"StoryPinVideoFormatsV2",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},a],storageKey:null}],storageKey:'videoList(version:"V_HLSV3_MOBILE")'}],storageKey:null}],type:"StoryPinVideoBlock",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});s.hash="695074f4aa0e5845fecc8d4bdf773a7e";let o=s},421018:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoWithContextLogging_pin",selections:[{args:null,kind:"FragmentSpread",name:"VideoWrapper_pin"}],type:"Pin",abstractKey:null};n.hash="93ed23334d5bac81ac8410f05c4f2031";let a=n},378770:(e,t,i)=>{var n,a;i.r(t),i.d(t,{default:()=>r});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useAutoplayOrgVideoOnHover_pin",selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"totalVideoDuration",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[n,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:a=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:a,storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};l.hash="2942f85ec1d9274bd2a1e72a4b5cf008";let r=l},148707:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Q});var n,a,l,r,s,o=i(667294);i(167912);var d=i(20256),u=i(616550),h=i(693967),c=i.n(h),g=i(507944),p=i(498905),m=i(78039),y=i(233846),v=i(51340),f=i(928362),x=i(967312),b=i(310030),S=i(785893);function T(e){return!(e.imageSpec_474x?.width&&e.imageSpec_474x.height&&e.imageSpec_474x.width>e.imageSpec_474x.height)&&e.imageSpec_474x||e.imageSpec_736x}let _=(void 0!==n||(n=i(742897)).hash&&"695074f4aa0e5845fecc8d4bdf773a7e"!==n.hash&&console.error("The definition of 'StoryPinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function w({alt:e,fetchPriority:t,onError:i=()=>{},onLoad:n=()=>{},pinKey:a,_fixCompletedOnLoad:l}){let{checkExperiment:r}=(0,x.r)(),{anyEnabled:s}=r("ads_iad_dweb"),o=(0,m.Z)(_,a),{dominantColor:u,isDownstreamPromotion:h,promoter:c}=o,g=!!c&&!h,p=function(e){let t=e.storyPinData?.pages||[],i=(t[0]?.blocks||[])[0]||{};return"StoryPinVideoBlock"===i.__typename&&3===i.blockType}(o),{height:y,width:v,url:f}=function({pin:e,useVideoThumbnail:t}){return t?function(e){let t=e.storyPinData?.pages||[],i=t[0]?.blocks||[],n=i[0]?.__typename==="StoryPinVideoBlock"?i[0]?.videoDataV2?.videoList?.vHLSV3MOBILE:null;return n?.thumbnail?{height:n?.height||0,width:n?.width||0,url:n.thumbnail||""}:T(e)}(e):T(e)}({pin:o,useVideoThumbnail:p&&(g&&s||!g)})??{};return(0,S.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{zIndex:b.Z.storyPinImage}},"data-test-id":"story-pin-image-box",width:"100%",children:f&&(0,S.jsx)(d.Ee,{_fixCompletedOnLoad:l,alt:e,color:u||"transparent",fetchPriority:t,naturalHeight:y??1,naturalWidth:v??1,onError:i,onLoad:n,src:f})})}var k=i(132588),P=i(813837),L=i(296823);let I=["ShoppingCarousel","ShoppingGridSmall","ShoppingGridSmallCarousel","ShoppingDynamicHeightGrid","VisualInspirationFocusPin","VisualInspirationPin","VisualInspirationShoppingPin"],F=(void 0!==a||(a=i(385505)).hash&&"228ed96182ff017f2d866065cbecf7b9"!==a.hash&&console.error("The definition of 'PinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a),V=({children:e,cropStoryPinImage:t,cropWidth:i,cropHeight:n})=>t?(0,S.jsx)(d.kC,{alignItems:"center",height:i?n:void 0,justifyContent:"start",width:i||void 0,children:e}):(0,S.jsx)(d.xu,{children:e}),C=({cropHeight:e,cropWidth:t,highResOnly:i,imageFit:n,isInDesktopCarousel:a,onError:l,onLoad:r,pinKey:s,saved:o=!1,surface:h,ssrImpressionFixEnabled:x})=>{let b=(0,y.ZP)(),T=(0,k.C)((0,u.TH)()),_=(0,m.Z)(F,s),{altText:C,autoAltText:E,carouselData:D,description:j="",dominantColor:K,gridTitle:M,isThirdPartyAd:W,title:A,videos:H}=_,B=(0,v.nk)(b.bt("This contains an image of: {{ pinTitle }}", "This contains an image of: {{ pinTitle }}", "web.altText", undefined, true),{pinTitle:A||M}).join(""),Z="",O,R=0,z=0;if(_.imageSpec_736x||_.imageSpec_orig||_.imageSpec_474x||_.imageSpec_236x){let e=_.imageSpec_236x;if(i)e=_.imageSpec_736x||_.imageSpec_orig||_.imageSpec_474x||_.imageSpec_236x;else{let{thumbnail:t,height:i,width:n}=H?.videoList?.vHLSV4||{};e=t?{url:t,height:i??1,width:n??1}:e}R=e?.height,z=e?.width,Z=e?.url,O=i?e?.url?`${e.url} 1x`:"":[_.imageSpec_236x?.url&&`${_.imageSpec_236x.url} 1x`,_.imageSpec_474x?.url&&`${_.imageSpec_474x.url} 2x`,_.imageSpec_736x?.url&&`${_.imageSpec_736x.url} 3x`,_.imageSpec_orig?.url&&`${_.imageSpec_orig.url} 4x`].filter(Boolean).join(", ")}let $=(0,g.Z)({altText:C,autoAltText:E,i18n:b})||!!j?.trim().length&&j||B;if(D)return(0,S.jsx)(P.Z,{_fixCompletedOnLoad:x,highResOnly:i,isThirdPartyAd:W,onError:l,onLoad:r,pinKey:_});let N=["ShoppingGridSmall","ShoppingGridSmallCarousel"].includes(h)?void 0:f.Ml,U=(0,L.Z)(h),G="non-story-pin-image";return(0,S.jsx)(d.kC,{alignItems:"center",justifyContent:"start",minHeight:N,children:(0,S.jsx)(d.xu,{flex:"grow",children:(0,S.jsx)("div",{className:c()({savedGradient:o}),children:_.storyPinDataId?(0,S.jsx)(V,{cropHeight:e,cropStoryPinImage:!!t&&(I.includes(h)||!!a),cropWidth:t,children:(0,S.jsx)(w,{_fixCompletedOnLoad:x,alt:$,fetchPriority:T?"low":void 0,onError:l,onLoad:r,pinKey:_})}):(0,S.jsx)(d.xu,{"data-test-id":G,height:t?e:void 0,width:t||void 0,children:(0,S.jsx)(p.Z,{_fixCompletedOnLoad:x,alt:$,color:"dominant"===U?K??"":U,crossOrigin:W?"anonymous":void 0,elementTiming:`grid-${G}-${h}`,fetchPriority:T?"low":void 0,fit:n,naturalHeight:R??1,naturalWidth:z??1,onError:l,onLoad:r,src:Z??"",srcSet:O})})})})})};var E=i(158759),D=i(472856),j=i(431867),K=i(993539),M=i(602766);let W={__style:{backgroundColor:"#000"}};function A({backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:n,pinId:a}){let l=(0,y.ZP)();return(0,S.jsxs)(d.Ee,{alt:l.bt("Pin image", "pin image", "image of a pin", undefined, true),naturalHeight:t,naturalWidth:i,src:e,children:[(0,S.jsx)(d.xu,{bottom:!0,dangerouslySetInlineStyle:W,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,S.jsxs)(d.xu,{"data-test-id":`video-end-card-${a}`,direction:"column",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",children:[(0,S.jsx)(d.iP,{rounding:2,children:(0,S.jsxs)(d.xu,{display:"flex",justifyContent:"center",padding:2,children:[(0,S.jsx)(d.JO,{accessibilityLabel:l.bt("Visit site", "Visit site", "Button when pressed goes to pin's website", undefined, true),color:"light",dangerouslySetSvgPath:{__path:K.Z},size:25}),(0,S.jsx)(d.xu,{margin:1}),(0,S.jsx)(d.xv,{color:"light",lineClamp:1,weight:"bold",children:l.bt("Visit site", "Visit site", "Button when pressed goes to pin's website", undefined, true)})]})}),(0,S.jsx)(d.xu,{margin:3}),(0,S.jsx)(d.iP,{onTap:n,rounding:2,children:(0,S.jsxs)(d.xu,{display:"flex",justifyContent:"center",padding:2,children:[(0,S.jsx)(d.JO,{accessibilityLabel:l.bt("Watch again", "Watch again", "Button when pressed restarts the video", undefined, true),color:"light",dangerouslySetSvgPath:{__path:M.Z},size:25}),(0,S.jsx)(d.xu,{margin:1}),(0,S.jsx)(d.xv,{color:"light",lineClamp:1,weight:"bold",children:l.bt("Watch again", "Watch again", "Button when pressed restarts the video", undefined, true)})]})})]})]})}function H({aspectRatio:e,children:t}){return(0,S.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{aspectRatio:e}},children:t})}var B=i(821332);let Z=new Set(["ConversationView","TodayTabFeed"]),O=(void 0!==l||(l=i(559210)).hash&&"72a606f26ad161609980c86fe071d95e"!==l.hash&&console.error("The definition of 'PinVideo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function R({isAutoplay:e,cropHeight:t,currentTime:i,highResOnly:n,onLoad:a,onError:l,saved:r,onTimeChange:s,isExperimentalPinRep:u,pinKey:h,surface:c,playing:g,rootMargin:p,viewType:y,viewParameter:v,cropWidth:f,video:b}){let T,_,[w,k]=(0,o.useState)(!1),[P,L]=(0,o.useState)(!g),I=(0,m.Z)(O,h),{checkExperiment:F}=(0,x.r)(),{isDownstreamPromotion:V,promoter:K}=I,M=(0,E.jL)(!!V,!!K),W=M&&!I.isEligibleForWebCloseup,R=u&&M&&I.isEligibleForWebCloseup&&!Z.has(c),{setCurrentVideo:z}=(0,D.G)(),$=!!R&&F("ads_web_disable_video_end_card").anyEnabled;e&&g&&P&&L(!1);let{url:N}=I.imageSpec_236x??{},{entityId:U,isPromoted:G}=I,q=(0,o.useCallback)(({event:e})=>{e.preventDefault(),e.stopPropagation(),z({pinId:U,isPromoted:!!G,currentTime:0}),k(!1)},[G,U,z]),J=(0,o.useCallback)(()=>{G&&($||k(R))},[G,R,$]),Q=b??I.videos?.videoList?.vHLSV4;if(!Q)return null;let{height:Y,thumbnail:X,width:ee,url:et}=Q,ei=b?.entityId??I.videos?.entityId??"",en=(ee??1)/(Y??1),ea=c&&(0,j.Z)(c)&&"UserProfilePinGrid"!==c;if(ea&&(en=1,T="transparent"),"VideoCarouselModule"===c&&(_="cover",en=(f??ee??1)/(t??Y??1)),w&&M)return(0,S.jsx)(d.xu,{children:(0,S.jsx)(A,{backgroundImage:N??"",naturalHeight:Y??1,naturalWidth:ee??1,onRestartVideo:q,pinId:U})});let el={highResOnly:n,onError:l,onLoad:a,pinKey:I,saved:r};ea&&(el={...el,cropHeight:t,cropWidth:f,imageFit:"contain"});let er=(0,S.jsx)(d.xu,{"data-test-id":"pinrep-video--placeholder","data-test-image-signature":N,children:(0,S.jsx)(H,{aspectRatio:en,children:(0,S.jsx)(C,{...el,ssrImpressionFixEnabled:!1,surface:c})})});return P?er:(0,S.jsx)(d.xu,{children:(0,S.jsx)(B.ZP,{aspectRatio:en,backgroundColor:T,captions:"",contextLogData:{viewParameter:v,component:0,objectId:U,video_id:ei,view:y},fallback:er,hlsConfig:{capLevelToPlayerSize:!0,startPosition:i||-1},isAutoPlay:!!e,loop:W||!u||!M||$,objectFit:_,onEnded:J,onPlay:()=>{},onPlayError:()=>{},onTimeChange:s,playing:g,poster:N||X||void 0,rootMargin:p,src:[{type:"video/m3u8",src:et}]??[],surface:c,videoStartTime:i,volume:0})})}var z=i(958659),$=i(320448),N=i(688655);let U=(void 0!==r||(r=i(378770)).hash&&"2942f85ec1d9274bd2a1e72a4b5cf008"!==r.hash&&console.error("The definition of 'useAutoplayOrgVideoOnHover_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function G(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let q=(void 0!==s||(s=i(708303)).hash&&"8e6a9272e57ad1033c4bf432c3adf854"!==s.hash&&console.error("The definition of 'PinVideoWithVisibility_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);class J extends o.Component{constructor(...e){super(...e),G(this,"calculateCurrentVideoTime",()=>{let{currentTimeFromPinRep:e,pin:t,videosAutoplaying:i}=this.props,{entityId:n}=t,a=(0,$.Z)(n,i);return this.currentVideoCurrentTime||a||e}),G(this,"handleVisibilityChanged",(e,t)=>{let{currentTimeFromPinRep:i,pin:n,setCurrentVideo:a,pauseAutoplay:l,videosAutoplaying:r}=this.props,{entityId:s,isPromoted:o}=n,d=(0,N.Z)(s,r),u=function(e,t){let{organicVideosAutoplaying:i,promotedVideosAutoplaying:n}=t,a={...i,...n};for(let t in a){let{paused:i}=a[t];if(t!==e&&!i)return!1}return!0}(s,r);e?o?a({pinId:s,isPromoted:o,currentTime:this.calculateCurrentVideoTime()}):(u||"VideoCarouselModule"===t)&&a({pinId:s,isPromoted:!!o,currentTime:this.calculateCurrentVideoTime(),surface:t}):!e&&d&&l({pinId:s,isPromoted:!!o,currentTime:i||this.currentVideoCurrentTime,surface:t})}),G(this,"handleVideoTimeChange",e=>{let{pin:t,onTimeChange:i,videosAutoplaying:n}=this.props,{entityId:a}=t;(0,N.Z)(a,n)&&(this.currentVideoCurrentTime=e.time),i&&i(e)})}componentDidMount(){this.props.onLoad&&this.props.onLoad()}componentDidUpdate(e){let{appInFocus:t}=e,{appInFocus:i,currentTimeFromPinRep:n,pauseAutoplay:a,pin:l,setCurrentVideo:r,videosAutoplaying:s}=this.props,{entityId:o,isPromoted:d}=l,u=(0,N.Z)(o,s);i!==t&&!i&&u?(this.pausedDueToBrowserOutOfFocus=!0,a({pinId:o,isPromoted:!!d,currentTime:n||this.currentVideoCurrentTime})):this.pausedDueToBrowserOutOfFocus&&i&&(this.pausedDueToBrowserOutOfFocus=!1,r({pinId:o,isPromoted:!!d,currentTime:this.calculateCurrentVideoTime()}))}componentWillUnmount(){let{currentTimeFromPinRep:e,pauseAutoplay:t,pin:i,videosAutoplaying:n}=this.props,{entityId:a,isPromoted:l}=i;(0,N.Z)(a,n)&&t({pinId:a,isPromoted:!!l,currentTime:e||this.currentVideoCurrentTime})}render(){let{cropHeight:e,isAutoplay:t,pin:i,surface:n,videosAutoplaying:a,viewParameter:l,viewType:r,highResOnly:s,onError:o,onLoad:d,saved:u,isExperimentalPinRep:h,rootMargin:c,cropWidth:g,video:p}=this.props,{entityId:m}=i,y=(0,$.Z)(m,a),v=(0,N.Z)(m,a),f={cropHeight:e,rootMargin:c,currentTime:y,isAutoplay:t,viewParameter:l,viewType:r,onTimeChange:this.handleVideoTimeChange,onVisibilityChanged:e=>this.handleVisibilityChanged(e,n),pinKey:i,surface:n,playing:v&&t,trackFullVisible:!1,highResOnly:s,onError:o,onLoad:d,saved:u,isExperimentalPinRep:h,cropWidth:g,...p?{video:p}:{}};return(0,S.jsx)(z.Z,{onVisibilityChanged:e=>this.handleVisibilityChanged(e,n),rootMargin:c,trackFullVisible:f.trackFullVisible,children:(0,S.jsx)(R,{...f})})}}function Q({pinKey:e,isHovering:t=!1,...i}){let{appUI:{appInFocus:n,isAutoplay:a,videosAutoplaying:l},pauseAutoplay:r,setCurrentVideo:s}=(0,D.G)(),d=(0,m.Z)(q,e),u=(0,o.useRef)(t);return!function({pinKey:e,isHovering:t,hoverState:i}){let n=(0,m.Z)(U,e),{setCurrentVideo:a,pauseAutoplay:l,appUI:{videosAutoplaying:r}}=(0,D.G)(),s=n?.videos?.videoList?.v720P||n?.videos?.videoList?.vHLSV4||n?.videos?.videoList?.vHLSV3MOBILE;(0,o.useEffect)(()=>{if(n){if(i.current!==t){let{entityId:e,isPromoted:i,storyPinData:o}=n,d=(0,$.Z)(e,r);if(s||o?.totalVideoDuration)if(t){let t=function(e,t){let{currentlyPlayingOrganicVideoId:i,organicVideosAutoplaying:n}=t;return i&&i!==e?i:Object.keys(n).find(e=>!1===n[e].paused)}(e,r);t&&l({currentTime:d,pinId:t,isPromoted:!1}),a({currentTime:d,pinId:e,isPromoted:!!i})}else i||l({currentTime:d,pinId:e,isPromoted:!!i})}i.current=t}},[t,i,l,n,a,s,r])}({pinKey:d,isHovering:t,hoverState:u}),(0,S.jsx)(J,{...i,appInFocus:n,isAutoplay:a,pauseAutoplay:r,pin:d,setCurrentVideo:s,videosAutoplaying:l})}},182997:(e,t,i)=>{i.d(t,{Z:()=>n});function n(e,t,i){let n,a,l,r=!!i?.leading,s=i?.trailing!==!1,o=i?.maxWait?Math.max(i.maxWait,t):void 0,d=null,u=0;function h(t){let i=n;return n=void 0,u=t,i&&(a=e(...i)),a}function c(e){let i=e-(l??0),n=e-u;return void 0===l||i>=t||i<0||void 0!==o&&n>=o}function g(){let e=Date.now();if(c(e))(d=null,s&&n)?h(e):n=void 0;else d=setTimeout(g,function(e){let i=e-(l??0),n=e-u,a=t-i;return void 0!==o?Math.min(a,o-n):a}(e))}function p(){null!==d&&clearTimeout(d),d=setTimeout(g,t)}function m(...e){let i=Date.now(),s=c(i);if(n=e,l=i,s){if(null===d)return u=i,d=setTimeout(g,t),r?h(i):a;else if(void 0!==o)return p(),h(i)}return null===d&&p(),a}return m.flush=function(){if(null!==d&&n){let e=Date.now();return clearTimeout(d),d=null,h(e)}return a},m.cancel=function(){null!==d&&clearTimeout(d),u=0,n=void 0,l=void 0,d=null},m}},993539:(e,t,i)=>{i.d(t,{Z:()=>n});let n="M17.496 14.572a1 1 0 0 1-1 1h-.001a1.001 1.001 0 0 1-.999-1.001l.002-4.652-7.29 7.288a.995.995 0 0 1-.707.293.999.999 0 0 1-.707-1.707l7.293-7.29L9.428 8.5a1 1 0 0 1 .001-2h.001l8.071.005-.005 8.067zM12 0C5.373 0 0 5.373 0 12c0 6.628 5.373 12 12 12 6.628 0 12-5.372 12-12 0-6.627-5.372-12-12-12z"},602766:(e,t,i)=>{i.d(t,{Z:()=>n});let n="M12 18.5A6.508 6.508 0 0 1 5.5 12c0-1.706.689-3.307 1.835-4.5H6.5a1 1 0 1 1 0-2h4.185v4.474a1 1 0 0 1-2 0V8.972A4.505 4.505 0 0 0 7.5 12c0 2.481 2.019 4.5 4.5 4.5s4.5-2.019 4.5-4.5a4.49 4.49 0 0 0-3.112-4.283 1 1 0 1 1 .615-1.902A6.482 6.482 0 0 1 18.5 12c0 3.584-2.916 6.5-6.5 6.5M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0"},131714:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(667294);function a(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class l extends n.Component{constructor(...e){super(...e),a(this,"ref",(0,n.createRef)()),a(this,"observer",null),a(this,"handleVisibilityChanged",(e,t)=>{this.props.onVisibilityChange(e,t)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let r=l},958659:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(20256),a=i(346754),l=i(785893);function r({onVisibilityChanged:e,children:t,...i}){let r=(0,a.Z)({onVisibilityChanged:e,...i});return(0,l.jsx)(n.xu,{ref:r,children:t})}},346754:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(667294);let a=new Map,l=null,r=e=>{e.forEach(e=>{let t=a.get(e.target);t&&t(e)})};function s({onVisibilityChanged:e,trackFullVisible:t,rootMargin:i}){let s=(0,n.useRef)(null),o=!1,d=()=>{let t;s.current instanceof HTMLElement&&(t=s.current,a.has(t))&&o&&(e(!1),o=!1)},u=(0,n.useCallback)(i=>{s.current instanceof HTMLElement&&((e,t="-64px 0px 0px 0px",i)=>{let n={root:"undefined"==typeof document?null:document.querySelector("#mainContainer"),rootMargin:t,threshold:[0,.5,1]};l=l||new window.IntersectionObserver(r,n),a.set(e,i),l.observe(e)})(s.current,i,i=>{if(!a.has(s.current))return;let n=t?i.intersectionRatio>=1:i.intersectionRatio>=.5,l=t?0===i.intersectionRatio:!n;if(!o&&n)(o=i.intersectionRatio>0||i.isIntersecting)&&e(!0);else o&&l&&d()})},[s.current]);return(0,n.useEffect)(()=>(u(i),()=>{if(s.current instanceof HTMLElement){var e;d(),e=s.current,l.unobserve(e),a.delete(e)}}),[u]),s}},320448:(e,t,i)=>{i.d(t,{Z:()=>n});function n(e,t){let{organicVideosAutoplaying:i,promotedVideosAutoplaying:n,videoCarouselModuleAutoplaying:a}=t,l={...i,...n,...a};return l[e]&&l[e].currentTime}},310030:(e,t,i)=>{i.d(t,{Z:()=>n});let n={debugPinImpressions:999,max:9999,pinActionWrapper:101,saved:102,storyPinImage:-1}},132588:(e,t,i)=>{i.d(t,{C:()=>n,_:()=>a});let n=e=>!!e&&/^\/pin\/[\w-]+\/?$/.test(e.pathname),a=e=>{let t=[...e].reverse().find(({location:e})=>e&&!n(e));return t&&t.location&&(({pathname:e})=>/^\/search\/pins\//.test(e))(t.location)?(({pathname:e,search:t})=>{let i=/^\/search\/pins\/(\?.*)$/.exec(e),n=(t||i&&i[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return n?decodeURIComponent(n[1]):""})(t.location):""}},813837:(e,t,i)=>{i.d(t,{Z:()=>x});var n,a=i(667294);i(422578);var l=i(20256),r=i(24963),s=i(78039),o=i(56063),d=i(233846),u=i(928362),h=i(967312),c=i(174646),g=i(826111),p=i(765575),m=i(785893);function y(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let v=(void 0!==n||(n=i(43086)).hash&&"4be444081491499e2b6e9d6768314918"!==n.hash&&console.error("The definition of 'DeprecatedCarousel_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);class f extends a.Component{constructor(...e){super(...e),y(this,"state",{showBadge:!0,startImpressionTimer:!1}),y(this,"renderBadge",()=>{let{carouselData:e,isCloseup:t,showCarouselBadge:i}=this.props;if(!e)return null;let{showBadge:n}=this.state,{carouselSlots:a,index:r}=e;return!t&&i?(0,m.jsx)(l.xu,{alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:{opacity:.8*!!n,transition:"opacity .3s"}},"data-test-id":"carousel-badge",display:"flex",height:35,justifyContent:"center",marginEnd:5,marginTop:5,position:"absolute",right:!0,rounding:2,width:35,zIndex:new l.Ry(1),children:(0,m.jsx)(l.xv,{color:"inverse",children:`${(r??0)+1}/${(a??[]).length}`})}):null}),y(this,"onLoadImage",()=>{this.setState({startImpressionTimer:!0}),this.props.onLoad?.()}),y(this,"onImageLoadError",()=>{this.setState({startImpressionTimer:!1}),this.props.onError?.()})}componentDidMount(){this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)}componentDidUpdate(e){let{showBadge:t}=this.state,{carouselData:i}=e,{carouselData:n}=this.props;if(!i||!n)return;let{index:a}=i,{index:l}=n;t&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)),a!==l&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.setState({showBadge:!0}))}componentWillUnmount(){this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout)}render(){let e,{isCloseup:t,carouselIndex:i,closeupHeight:n,closeupWidth:a=0,widthRatio:r=1,cropHeight:s,cropWidth:d,carouselData:h,disableTransition:c,highResOnly:y,pinId:v,imageSignature:f,isEditMode:x,isDenseView:b,isThirdPartyAd:S,_fixCompletedOnLoad:T}=this.props;if(!h)return null;if(r>1||r<0)throw Error("widthRatio should be between 0 and 1 inclusive");let{carouselSlots:_}=h,w=h.index??0,k=void 0!==i?i:w??0,P=!t&&d,{imageSizeMap:L}=_[k]||{},I=Math.floor((e=t?a:P||(y?474:b?o.Lo:o.yF))*r),F=L?.["236x"]||{},V=s||F.height||0,C=d||F.width||236,E=n||V/C*I,D=(e=>{let t=e.reduce((e,t)=>{let{imageSizeMap:i}=t,{height:n,width:a}=i?.["736x"]||i?.["236x"]||{},l=`${a??1}x${n??1}`,r=e[l]?.times||0;return{...e,[l]:{imageHeight:n,imageWidth:a,times:r+1}}},{}),i=Object.keys(t).reduce((e,i)=>t[i].times>e.times?t[i]:e,{times:-1,imageHeight:-1,imageWidth:-1});return Object.keys(t).length>1?{imageHeight:i.imageHeight,imageWidth:i.imageWidth}:null})(_);return(0,m.jsxs)(l.xu,{alignItems:"center","data-test-id":"carousel-pin","data-test-image-signature":f,display:"flex",height:E,minHeight:u.Ml,overflow:"hidden",children:[!x&&this.renderBadge(),(0,m.jsx)(p.JE,{carouselData:{...h,type:"canonical"},impressionType:"Pin",isPaused:!this.state.startImpressionTimer,loggingId:v,slotIndex:w??0,viewParameter:72,viewType:1,children:({impressionTrackerRef:e})=>(0,m.jsx)(l.xu,{ref:e,"data-test-id":`carousel-impression-ref-${v}-${w}`,height:E,overflow:"hidden",position:"absolute",width:I})},`carousel-impression-key-${k}`),(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{transition:c?"":"left .3s",left:(0,g.vF)(_.length,I,e,k)}},direction:"row",display:"flex",height:"100%",left:!0,position:"relative",width:I*_.length,children:_.map((i,n)=>{if(t){let t=n===_.length-1;return(({pinId:e,slot:t,slotIndex:i,onError:n,onLoad:a,widthToUse:r,gap:s},o)=>{let{url:d,width:u,height:h}=["564x","736x","474x","236x"].map(e=>t.imageSizeMap?.[e]).find(e=>e?.url)||{},{details:c=""}=t,p=(0,g.GH)(c,o,i);return(0,m.jsx)(l.xu,{"data-test-id":"carousel-slot-container",height:"100%",marginEnd:s,width:r,children:(0,m.jsx)(l.zd,{height:"100%",wash:!0,children:d&&(0,m.jsx)(l.Ee,{alt:p,fit:"contain",naturalHeight:h??1,naturalWidth:u??1,onError:n,onLoad:a,src:d})})},`carousel-slot-${e}-${i}`)})({pinId:v,slot:i,slotIndex:n,onError:this.onImageLoadError,onLoad:this.onLoadImage,widthToUse:I,gap:+(I<e&&!t)},this.props.i18n)}return((e,t,i,n,a,r,s,o,d,u,h,c,p,y,v,f)=>{let x,{imageSizeMap:b,details:S=""}=i,T=236,_=236,w="";r?(T=474,_=b&&Math.min(T/.8,T/((b["564x"]?.width??1)/(b["564x"]?.height??1))),w=b&&b["564x"]?.url):b&&b["736x"]?(_=b&&b["736x"]&&b["736x"].height,T=b&&b["736x"]&&b["736x"].width,w=b&&b["736x"]&&b["736x"].url):b&&b["236x"]&&(_=b&&b["236x"]&&b["236x"].height,T=b&&b["236x"]&&b["236x"].width,w=b&&b["236x"]&&b["236x"].url),p&&y&&(_=Math.min(p*y,_??1)),x=r?`${b?.["564x"]?.url??""} 1x`:[b?.["474x"]&&`${b["474x"].url??""} 2x`,b?.["736x"]&&`${b["736x"].url??""} 3x`,b?.orig&&`${b.orig.url??""} 4x`].filter(Boolean).join(", ");let k=(0,g.GH)(S,t,a),P=c?void 0:_,L=c?void 0:T,{boxHeight:I,boxWidth:F}=v?{boxHeight:v?.imageHeight,boxWidth:v?.imageWidth}:{boxHeight:P,boxWidth:L};return(0,m.jsx)(l.xu,{"data-test-id":"carousel-slot-container",height:I??void 0,width:F??void 0,children:(0,m.jsx)(l.xu,{"data-test-id":`carousel-img-${a}`,height:c?h:void 0,width:c||void 0,children:w&&(0,m.jsx)(l.Ee,{_fixCompletedOnLoad:e,alt:k,crossOrigin:f?"anonymous":void 0,fit:c?"cover":"none",naturalHeight:_??1,naturalWidth:T??1,onError:s,onLoad:o,src:w,srcSet:x})})},`carousel-slot-${n}-${a}`)})(T,this.props.i18n,i,v,n,y,this.onImageLoadError,this.onLoadImage,0,0,s,d,E,I,D,S)})})]})}}function x({pinKey:e,...t}){let i=(0,d.ZP)(),{checkExperiment:n}=(0,h.r)(),{isAuthenticated:a}=(0,c.B)(),l=(0,s.Z)(v,e),o=(0,r.Z)(l),u=o&&{...o,carouselSlots:function(e){let t=["236x","474x","564x","736x"].map(t=>{let i=Math.min(...e.map(e=>e.imageSizeMap?.[t]?.height||1/0)),n=Math.min(...e.map(e=>e.imageSizeMap?.[t]?.width||1/0));return{imageKey:t,height:i,width:n}});return e.map(e=>t.reduce((e,{imageKey:t,height:i,width:n})=>e.imageSizeMap?.[t]?{...e,imageSizeMap:{...e.imageSizeMap,[t]:{...e.imageSizeMap[t],height:i,width:n}}}:e,e))}(o.carouselSlots)};return(0,m.jsx)(f,{...t,carouselData:u,checkExperiment:n,i18n:i,imageSignature:l.imageSignature,isAuthenticated:a,pinId:l.entityId})}y(f,"defaultProps",{showCarouselBadge:!0})},826111:(e,t,i)=>{i.d(t,{CU:()=>a,GH:()=>s,Iw:()=>r,c3:()=>h,gA:()=>o,tD:()=>l,vF:()=>d,yR:()=>u});let n=({containerWidth:e,contentWidth:t,index:i,slotAndGapWidth:a})=>{let l=i-1,r=l*a;return t-r>=e?r:n({index:l,slotAndGapWidth:a,containerWidth:e,contentWidth:t})},a=({containerWidth:e,gap:t,index:i,numberOfSlides:a,slotWidth:l,paddingX:r})=>{let s=l+t,o=s*a,d=r?e-r:e;if(o<=d)return 0;let u=d/s,h=(({index:e,numberOfSlides:t,slidesShownPerPosition:i})=>t-e-Math.floor(i)<1)({index:i,numberOfSlides:a,slidesShownPerPosition:u})?(({containerWidth:e,contentWidth:t,gap:i,index:a,slidesShownPerPosition:l,slotAndGapWidth:r,paddingX:s=0})=>n({containerWidth:e,contentWidth:t,index:a,slotAndGapWidth:r})+(({slidesShownPerPosition:e,slotAndGapWidth:t})=>t-(e-parseInt(e,10))*t)({slidesShownPerPosition:l,slotAndGapWidth:r})-i+s)({containerWidth:d,contentWidth:o,gap:t,index:i,slidesShownPerPosition:u,slotAndGapWidth:s,paddingX:r}):i*s;return h?Math.round(-h):0},l=({containerWidth:e,gap:t,index:i,numberOfSlides:n,slotWidth:l,isHorizontalScrollable:r,paddingX:s,rows:o=1})=>{let d=n/o*l+t*(n-1),u=s?e-s:e;return 0!==e&&(!!(d<=u)||(r?d<=u:Math.abs(a({containerWidth:e,gap:t,index:i,numberOfSlides:n,slotWidth:l,paddingX:s}))+t>=d-u))},r=({containerWidth:e,currentIndex:t,gap:i,index:n,numberOfSlides:l,slotWidth:r,paddingX:s})=>{let o=r+i,d=s?e-s:e;if(o*l<=d||0===e)return!0;let u=a({containerWidth:e,gap:i,index:t,numberOfSlides:l,slotWidth:r,paddingX:s}),h=s?d+o+s:e+o;return u+o*n<h},s=(e,t,i)=>e||`${t.bt("carousel image", "carousel image", "Alternate text for a carousel image that indicates it is a carousel pin, with carousel index followed", undefined, true)} ${i}`,o=({highResOnly:e,slot:t})=>{let{images:i}=t;return e?`${i?.["564x"]?.url??""} 1x`:[i?.["474x"]&&`${i["474x"].url??""} 2x`,i?.["736x"]&&`${i["736x"].url??""} 3x`,i?.orig&&`${i.orig.url??""} 4x`].filter(Boolean).join(", ")},d=(e,t,i,n,a=0,l)=>{let r=l?i-l:i;if(r===t)return-(n*t*1)+(l||0);let s=Math.floor(r-t),o=t+a;return n===e-1?-1*n*o+s+(l||0):-1*n*o+(l||0)},u=(e,t,i,n,a,l,r)=>{if(!e||t<=0)return 0;let s=Math.floor(i*n),o=e?.clientWidth||l*s;return Math.round(((r?t-r:t)+(r?o-r:o)-s/2)/(s+a))-1},h=(e,t,i,n,a,l)=>{e.current&&t&&e.current.scrollBy({left:(i-n)*(a+l),behavior:"smooth"})}},821332:(e,t,i)=>{i.d(t,{ZP:()=>I});var n,a=i(667294);i(422578);var l=i(20256),r=i(19963),s=i(182997),o=i(78039),d=i(131714),u=i(967312),h=i(174646),c=i(406706),g=i(422908),p=i(113329),m=i(992114),y=i(757653),v=i(785893);function f(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let x=(0,y.Z)(()=>Promise.all([i.e(97270),i.e(93041),i.e(78716),i.e(95813)]).then(i.bind(i,380122)),void 0,e=>380122,"app-www-video-VideoWrapper",e=>[97270,93041,78716,95813]),b=[0,.25,.5,.75,.95,.97],S=[0,.5,.8,.99,1],T={rootMargin:"-64px 0px 0px 0px",threshold:[...p.iM]},_=Object.freeze({LOADING:0,PLAYING:1,PAUSED:2,STALLING:3}),w=(void 0!==n||(n=i(421018)).hash&&"93ed23334d5bac81ac8410f05c4f2031"!==n.hash&&console.error("The definition of 'VideoWithContextLogging_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function k(){return new Date().getTime()}function P(e){return!!e.volume&&e.volume>0}class L extends a.Component{constructor(e){super(e),f(this,"videoWrapperRef",(0,a.createRef)()),f(this,"handleWindowResize",()=>{if(!this.fullscreen){let e=this.getDimensions(),{height:t,width:i}=this.currentInterval;e.height!==t||e.width!==i?(this.lastLoggedTime.startTime=0,this.startNewInterval(e)):(this.currentInterval.windowHeight=e.windowHeight,this.currentInterval.windowWidth=e.windowWidth)}}),f(this,"handlePlayheadDown",({event:e})=>{let{onPlayheadDown:t}=this.props;this.setState({seeking:!0}),t&&t({event:e})}),f(this,"handlePlayheadUp",({event:e})=>{let{onPlayheadUp:t}=this.props;this.setState({seeking:!1}),t&&t({event:e})}),f(this,"handleLoop",()=>{this.videoTime=0}),f(this,"handlePlaying",e=>{this.logVideoStart(),this.props.onPlaying&&this.props.onPlaying(e)}),f(this,"handleTimeChange",e=>{let{seeking:t,ready:i}=this.state;if(!this.currentInterval.videoDuration)return;let n=1e3*e.time,a=function(e,t,i,n){if(e>t||i<=0)return null;for(let a of n){let n=a*i;if(e<=n&&t>n)return a}return null}(this.videoTime,n,this.currentInterval.videoDuration,b);if("number"==typeof a&&this.props.playing&&!t&&i){let e=k();this.props.isMetricThrottleExpEnabled?this.isVideoEventLogIntervalMet("currentTime")&&this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*a),quartilePercentValue:a}):this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*a),quartilePercentValue:a})}this.videoTime=n,this.props.onTimeChange&&this.props.onTimeChange(e)}),f(this,"handleDurationChange",e=>{this.currentInterval.videoDuration=1e3*e.duration,this.props.onDurationChange&&this.props.onDurationChange(e)}),f(this,"handleReady",e=>{let{ready:t}=this.state;t||(this.lastLoggedTime.startTime=0,this.setState({ready:!0})),this.props.onReady&&this.props.onReady(e)}),f(this,"handleEnded",e=>{this.props.isMetricThrottleExpEnabled?this.isVideoEventLogIntervalMet("endTime")&&this.logFourthQuartileEvent():this.logFourthQuartileEvent(),this.props.loop&&(this.startNewInterval(),this.currentInterval.videoStartTime=0),this.props.onEnded&&this.props.onEnded(e)}),f(this,"handleVisibilityChange",e=>{if(0===e.length)return;let t=function(e){for(let t=0;t<S.length;t+=1){let i=S[t],n=S[t+1];if(null==n||i<=e&&e<n)return i}return null}(Number.parseFloat(e.slice(-1)[0].intersectionRatio.toFixed(2)));"number"==typeof t&&(this.visible=t>=.5),null==t||t===this.currentInterval.viewability||this.fullscreen||(0===t?this.startNewInterval({viewability:t,playbackState:_.PAUSED}):this.startNewInterval({viewability:t}))}),f(this,"handleFullscreenChange",({event:e,fullscreen:t})=>{if(t){let{height:e,width:t}=window.screen;this.startNewInterval({height:e,width:t,windowHeight:e,windowWidth:t})}else t||this.startNewInterval(this.getDimensions());this.fullscreen=t,this.props.onFullscreenChange&&this.props.onFullscreenChange({event:e,fullscreen:t})}),f(this,"handleClose",()=>{this.startNewInterval()}),this.state={ready:!1,seeking:!1,started:!1};let t=k();this.handleWindowResize=(0,s.Z)(this.handleWindowResize,1e3),this.currentInterval={videoDuration:0,startTime:t,endTime:t,videoStartTime:0,videoEndTime:0,isAudible:P(e),playbackState:this.getPlaybackState(e,this.state),quartile:-1,quartilePercentValue:0,height:null,width:null,windowHeight:null,windowWidth:null,viewability:null},this.videoTime=0,this.fullscreen=!1,this.visible=null,this.lastLoggedTime={startTime:0,endTime:0,currentTime:0}}componentDidMount(){this.currentInterval={...this.currentInterval,...this.getDimensions()},window.addEventListener("resize",this.handleWindowResize),window.addEventListener("beforeunload",this.handleClose)}componentDidUpdate(e,t){let i={};P(e)&&!P(this.props)?i.isAudible=!1:!P(e)&&P(this.props)&&(i.isAudible=!0);let n=this.getPlaybackState(this.props,this.state);this.getPlaybackState(e,t)!==n&&(i.playbackState=n),Object.keys(i).length>0&&this.startNewInterval(i)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("beforeunload",this.handleClose),this.startNewInterval()}getPlaybackState(e,t){return t.ready?e.playing&&!t.seeking?_.PLAYING:_.PAUSED:_.LOADING}getDimensions(){let e,t;if(this.videoWrapperRef.current){let i=this.videoWrapperRef.current;i.clientHeight&&i.clientWidth&&(e=i.clientHeight,t=i.clientWidth)}return{height:e,width:t,windowHeight:window.innerHeight,windowWidth:window.innerWidth}}logMetricStat(e){let{requestContext:t}=this.props,i=t?.userAgent||{},n={appType:i.isMobile||i.isTablet?"WEB_MOBILE":"WEB_DENZEL",country:t?.country??"unknown",browserName:i.browserName,osName:i.osName,browserType:i.browserType,browserVersion:i.browserVersion,type:e};(0,m.nP)("webapp.metrics.videoLogging.skippedEvents",{tags:n})}isVideoEventLogIntervalMet(e){let t=k();return 250>Math.abs(t-this.lastLoggedTime[e])?(this.logMetricStat(e),!1):(this.lastLoggedTime[e]=t,!0)}logVideoEvent(e,t){let{closeupStoryPinViewability:i,contextLogData:n,logContextEvent:a,playing:l,surface:r}=this.props,{seeking:s}=this.state,{height:o,width:d,windowHeight:u,windowWidth:h,viewability:c,...g}=t;if(null!=o&&null!=d&&null!=u&&null!=h&&null!=c){let t={...g,gridAutoplay:6904===e&&l&&!s&&("AuthHomefeed"===r||"SearchItem"===r||"RelatedPinGrid"===r||"PdpRelatedPinGrid"===r),height:o,width:d,windowHeight:u,windowWidth:h,viewability:i||c};a({event_type:e,...function(e){let{eventData:{videoEvent:{gridAutoplay:t,videoDuration:i,startTime:n,endTime:a,videoStartTime:l,videoEndTime:r,isAudible:s,height:o,width:d,playbackState:u,quartile:h,quartilePercentValue:c,windowHeight:g,windowWidth:p,viewability:m}},component:y,objectId:v,view:f,viewParameter:x,...b}=e;return{component:y,object_id_str:v,view_type:f,view_parameter:x,aux_data:{...b},event_data:{videoEventData:{gridAutoplay:t,videoDuration:i?Math.floor(i):0,time:n,endTime:a,videoTime:l?Math.floor(l):0,endVideoTime:r?Math.floor(r):0,isAudible:s,height:o,width:d,playbackState:u,quartile:h,quartilePercentValue:c,windowHeight:g,windowWidth:p,viewability:m}}}}({...n,view:this.fullscreen?108:n.view,eventData:{videoEvent:t}})})}}logFourthQuartileEvent(){let e=k();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:4,quartilePercentValue:1})}logVideoStart(){if(this.state.started)return;let{contextLogData:e,setVideoPlayed:t,shouldLogVideoStart:i}=this.props;if(i){let e=k();this.logVideoEvent(3621,{...this.currentInterval,startTime:e,endTime:e,videoEndTime:this.videoTime})}t(e.objectId),this.setState({started:!0})}startNewInterval(e){let t=k();this.props.isMetricThrottleExpEnabled?this.isVideoEventLogIntervalMet("startTime")&&this.logVideoEvent(6904,{...this.currentInterval,endTime:t,videoEndTime:this.videoTime}):this.logVideoEvent(6904,{...this.currentInterval,endTime:t,videoEndTime:this.videoTime}),this.currentInterval={...this.currentInterval,...e,startTime:t,videoStartTime:this.videoTime,endTime:-1,videoEndTime:-1}}render(){let{rootMargin:e,surface:t,aspectRatio:i,backgroundColor:n,captions:a,contextLogData:r,controls:s,fallback:o,hlsConfig:u,isAutoPlay:h,loop:g,objectFit:p,onLoadedChange:m,onControlsPause:y,onControlsPlay:f,onSeek:b,onVolumeChange:S,pin:_,playbackRate:w,playing:k,playsInline:P,poster:L,preload:I,seekTime:F,src:V,videoStartTime:C,volume:E,video:D,variant:j}=this.props,{seeking:K}=this.state;return void 0!==e&&(T.rootMargin=t?(0,c.eL)(t):e),(0,v.jsx)(d.Z,{onVisibilityChange:this.handleVisibilityChange,options:T,children:e=>(0,v.jsx)(l.xu,{ref:t=>{e.current=t,this.videoWrapperRef.current=t},height:"inherit",children:(0,v.jsx)(x,{aspectRatio:i,backgroundColor:n,captions:a,contextLogData:r,controls:s,fallback:o,hlsConfig:u,isAutoPlay:h,loop:g,objectFit:p,onControlsPause:y,onControlsPlay:f,onDurationChange:this.handleDurationChange,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onLoadedChange:m,onLoop:this.handleLoop,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onPlaying:this.handlePlaying,onReady:this.handleReady,onSeek:b,onTimeChange:this.handleTimeChange,onVolumeChange:S,pinKey:_,playbackRate:w,playing:!K&&k,playsInline:P,poster:L,preload:I,seekTime:F,src:V,variant:j,video:D,videoStartTime:C,visible:this.visible,volume:E})})})}}function I(e){let{pinKey:t}=e,i=(0,o.Z)(w,t),{logContextEvent:n}=(0,r.u)(),{checkExperiment:a}=(0,u.r)(),{setVideoPlayed:l}=(0,g.H)(),s=a("web_video_start_log").anyEnabled,d=a("web_metric_video_throttle").anyEnabled,c=(0,h.B)();return(0,v.jsx)(L,{...e,isMetricThrottleExpEnabled:d,logContextEvent:n,pin:i,requestContext:c,setVideoPlayed:l,shouldLogVideoStart:s})}f(L,"defaultProps",l.nk.defaultProps)},113329:(e,t,i)=>{i.d(t,{Ul:()=>l,VS:()=>n,hy:()=>r,iM:()=>a,j4:()=>s});let n=2,a=[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.11,.12,.13,.14,.15,.16,.17,.18,.19,.2,.21,.22,.23,.24,.25,.26,.27,.28,.29,.3,.31,.32,.33,.34,.35,.36,.37,.38,.39,.4,.41,.42,.43,.44,.45,.46,.47,.48,.49,.5,.51,.52,.53,.54,.55,.56,.57,.58,.59,.6,.61,.62,.63,.64,.65,.66,.67,.68,.69,.7,.71,.72,.73,.74,.75,.76,.77,.78,.79,.8,.81,.82,.83,.84,.85,.86,.87,.88,.89,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1],l={backgroundImage:"linear-gradient(to top, rgba(0, 0, 0, .4), rgba(0, 0, 0, 0))",pointerEvents:"none",bottom:0},r=128,s=e=>e&&document.querySelector(`video[poster="${e}"]`)||null}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/PinVideoWithVisibilityWrapper.en_GB-28ade21d12db3ac0.mjs.map